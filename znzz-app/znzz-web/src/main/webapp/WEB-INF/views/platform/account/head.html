<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>综合监控</title>
	<!--新版 首页公共头部,可加载公共js,css -->
    
    <link rel="shortcut icon" href="${base!}/favicon.ico" type="image/x-icon" />
    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <!-- Bootstrap 3.3.7 -->
    <link rel="stylesheet" href="${base!}/assets/bootstrap/css/bootstrap.min.css">
   <link rel="stylesheet" href="${base!}/assets/plugins/select2/select2.min.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="${base!}/assets/plugins/font-awesome/css/font-awesome.min.css">
    <!-- Ionicons -->
	<link rel="stylesheet" href="${base!}/assets/plugins/Ionicons/css/ionicons.min.css">
    <!-- Theme style -->
  <link rel="stylesheet" href="${base!}/assets/dist/css/AdminLTE.min.css">
    <!-- AdminLTE Skins. Choose a skin from the css/skins
         folder instead of downloading all of them to reduce the load. -->
   <link rel="stylesheet" href="${base!}/assets/dist/css/skins/_all-skins.min.css">
    <!-- Morris chart -->
    <!-- <link rel="stylesheet" href="${base!}/assets/plugins/morris.js/morris.css"> -->
    <!-- jvectormap -->
    <link rel="stylesheet" href="${base!}/assets/plugins/jvectormap/jquery-jvectormap.css">
    <!-- Date Picker -->
    <link rel="stylesheet" href="${base!}/assets/plugins/bootstrap-datepicker/dist/css/bootstrap-datepicker.min.css">
    <!-- Daterange picker -->
    <link rel="stylesheet" href="${base!}/assets/plugins/bootstrap-datepicker/dist/css/bootstrap-datepicker.css">
    <!-- bootstrap wysihtml5 - text editor -->
    <link rel="stylesheet" href="${base!}/assets/plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.css">
    <link rel="stylesheet" href="${base!}/assets/plugins/iCheck/all.css">
    <link rel="stylesheet" href="${base!}/assets/dist/css/index3.css">
    <% if(obj.css=="white") {%>
      <link rel="stylesheet" href="${base!}/assets/dist/css/index_w.css?v=20171218">
    <%}else{%>
       <link rel="stylesheet" href="${base!}/assets/dist/css/index_b.css?v=20171218">
    <%}%>
	<![endif]-->
    
    
      <!-- jQuery 3 -->
<script src="${base!}/assets/plugins/jQuery/jquery.min.js"></script>
<script src="${base!}/assets/plugins/jquery.cookie.js"></script>
<!-- jQuery UI 1.11.4 -->
<script src="${base!}/assets/plugins/jQueryUI/jquery-ui.js"></script>
<!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
<script>
    $.widget.bridge('uibutton', $.ui.button);
</script>
<!-- Bootstrap 3.3.7 -->
<script src="${base!}/assets/bootstrap/js/bootstrap.min.js"></script>
	<script src="${base!}/assets/plugins/select2/select2.full.min.js"></script>
<!-- Morris.js charts -->
<!-- <script src="${base!}/assets/plugins/raphael/raphael.min.js"></script>
<script src="${base!}/assets/plugins/morris.js/morris.min.js"></script> -->
<!-- Sparkline -->
<script src="${base!}/assets/plugins/jQuery/jquery.sparkline.min.js"></script>
<!-- jvectormap -->
<script src="${base!}/assets/plugins/jvectormap/jquery-jvectormap-1.2.2.min.js"></script>
<script src="${base!}/assets/plugins/jvectormap/jquery-jvectormap-world-mill-en.js"></script>
<!-- jQuery Knob Chart -->
<script src="${base!}/assets/plugins/jQuery/jquery.knob.min.js"></script>
<!-- daterangepicker -->
<script src="${base!}/assets/plugins/moment/min/moment.min.js"></script>
<script src="${base!}/assets/plugins/bootstrap-daterangepicker/daterangepicker.js"></script>
<!-- datepicker -->
<script src="${base!}/assets/plugins/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js"></script>
<script src="${base!}/assets/plugins/bootstrap-datepicker/dist/locales/bootstrap-datepicker.zh-CN.min.js"></script>
<!-- Bootstrap WYSIHTML5 -->
<script src="${base!}/assets/plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.all.min.js"></script>
<!-- Slimscroll -->
<script src="${base!}/assets/plugins/jQuery/jquery.slimscroll.min.js"></script>
<!-- FastClick -->
<script src="${base!}/assets/plugins/fastclick/fastclick.js"></script>
<!-- AdminLTE App -->
<!-- AdminLTE dashboard demo (This is only for demo purposes) -->
<!-- <script src="${base!}/assets/dist/js/pages/dashboard.js"></script> -->
<script src="${base!}/assets/plugins/iCheck/icheck.min.js"></script>
<!-- AdminLTE for demo purposes -->
<script src="${base!}/assets/dist/js/echarts.min.js"></script>
    <script src="${base!}/assets/dist/js/warning.js"></script>
    <style type="text/css">
       .myclass0{background-color: #FF7F50}
		.myclass1{background-color: #FF8C00}
		.myclass2{background-color: #6495ED}
		.myclass3{background-color: #3CB371}
		.myclass4{background-color: #9370DB}
		.myclass5{background-color: #DB7093}
    </style>
</head>
<body style="background-color: #eeeeee;height: 100%">
<div  class="container no-padding no-margin" style="width: 100%;">
<div class="nav-bar">
            <%
		      var unit=@shiro.getPrincipalProperty('unit');
		      var nickName=@shiro.getPrincipalProperty('nickName');
			  var username=@shiro.getPrincipalProperty('username');
	        %>
     <a href="${base!}/platform/home" style="color: white;">
        <div class="header-left col-sm-2 text-center" id="yqbgc">
            <span class="header-left-title">仪器设备管理系统</span>
        </div>
        </a>
    <div class="header-right">
        <div class="col-sm-6 head-href-blue no-padding">
            <div class="head-nav-white">
                <a href="${base}/platform/account/indexNew">首页</a>
            </div>
            <%
            var fastIntoMenus= @shiro.getPrincipalProperty('userFastIntoMenu');
            for(fastIntoMenu in fastIntoMenus){
            %>
            <div>
                <% if(!isEmpty(fastIntoMenu)){ %>
                <a data-pjax="" href="${base}${fastIntoMenu.href}">${fastIntoMenu.name}</a>
                <%}%>
            </div>
            <%}%>

        </div>
        <div class="col-sm-4 no-padding clearfix">
            <!--<a href="${base!}/platform/home"><div class="pull-left">-->
            <!--<img id="bkimg" src="${base!}/assets/dist/img/icon-header${obj.icon}.png" width="24" height="20" style="margin:0 11px 0 30px;" class="vertical-middle">-->
            <!--<span class="back-stage-text vertical-middle">后台管理</span>-->
            <!--</div>-->
            <!--</a>-->

            <div class="text-right">
                <span style="color: #ffffff;font-size: 12px;" id="timeDay"></span>
                <span style="color: #ffffff;font-size: 12px;" id="timeHour"></span>&nbsp;&nbsp;&nbsp;
                <div class="inline-block" style="position: relative;padding-right: 10px;">
                    <!--消息提醒-->
                    <a href="${base}/sys/message/info/" class="dropdown" style="color: #FFFFFF;">
                        <i class="fa fa-bell-o"></i>
                        <span class="label label-warning" style="position: absolute;top: -9px;left: 3px;padding: 2px 3px;"></span>
                    </a>
                </div>
                <div id="userId" style="display: none">${@shiro.getPrincipalProperty('id')}</div>
                <span style="color: #ffffff;font-size: 12px;">${unit.name}</span>

                <div class="dropdown" style="display: inline-block;">

                    <button class="dropdown-toggle header-right" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" aria-expanded="false" style="border: 0;">
                        <img src="${base!}/assets/dist/img/user2-160x160.jpg" width="30" height="30" alt="User Image" style="border-radius: 50%;">
                        <span class="hidden-xs" style="font-size: 16px;color: #ffffff;">${(@nickName==""||@nickName==null)?username:nickName}</span>
                        <span class="caret"></span>
                    </button>
                    <ul class="dropdown-menu dropdown-menu-right no-padding no-margin second-drop-menu" aria-labelledby="dropdownMenu1">
                        <li class="text-center">
                            <img src="${base!}/assets/dist/img/user2-160x160.jpg" class="img-circle" alt="User Image">

                            <div style="line-height:20px;color:#fff;">${@shiro.getPrincipalProperty('unitid')} </div>
                            <div style="line-height:20px;color:#fff;">${@shiro.getPrincipalProperty('email')}</div>


                        </li>

                        <li role="separator" class="divider"></li>
                        <li >

                            <button class="btn btn-default pull-left" id="changeTheme">切换主题</button>
                            <input type="hidden" id="themeToTheme" value="">
                        </li>
                        <li>

                            <button class="btn btn-default pull-right" id="logout">退出系统</button>

                        </li>


                    </ul>

                </div>
            </div>
        </div>
    </div>

    </div>
 	${layoutContent}
    
</div>
    <form class="modal fade" id="loadModal" data-backdrop="static" data-keyboard="false">
        <div class="modal-dialog">
            <div class="modal-body no-padding" style="margin: 69% auto;">
                <div class="spinner">
                    <div class="dot1"></div>
                    <div class="dot2"></div>
                </div>
            </div>
        </div>
    </form>
  

<script type="text/javascript">
    $(function () {
        $(".head-href-blue > div").each(function (index) {
            $(this).click(function () {
                $(".head-href-blue > div").removeClass('head-nav-white');
                $(".head-href-blue > div").eq(index).addClass("head-nav-white");
            })
        })
    });
//显示系统时间
function showRightTime(){
		var str,colorhead,colorfoot;
		var objD=new Date();
	  var yy = objD.getYear();
	   if(yy<1900) yy = yy+1900;
	  var MM = objD.getMonth()+1;
	   if(MM<10) MM = '0' + MM;
	  var dd = objD.getDate();
	   if(dd<10) dd = '0' + dd;
	  var hh = objD.getHours();
	   if(hh<10) hh = '0' + hh;
	  var mm = objD.getMinutes();
	   if(mm<10) mm = '0' + mm;
	  var ss = objD.getSeconds();
	   if(ss<10) ss = '0' + ss;
	  var ww = objD.getDay();
	   if ( ww==0 ) colorhead="<font color=\"#FF0000\">";
	   if ( ww > 0 && ww < 6 ) colorhead="<font color=\"#373737\">";
	   if ( ww==6 ) colorhead="<font color=\"#008000\">";
	   if (ww==0) ww="星期日";
	   if (ww==1) ww="星期一";
	   if (ww==2) ww="星期二";
	   if (ww==3) ww="星期三";
	   if (ww==4) ww="星期四";
	   if (ww==5) ww="星期五";
	   if (ww==6) ww="星期六";
	$("#timeDay").html(yy+"年"+MM+"月"+dd+"日 ") ;
	$("#timeHour").html(hh+":"+mm+":"+ss +"&nbsp;"+ww) ;
	//一秒刷新一次显示时间
	var timeID=setTimeout(showRightTime,1000);
}
//显示铃铛数量
function showMessageCount() {
    var id = $("#userId").text();
    $.post("${base}/sys/message/info/getMessageCount/"+id, {"id":id}, function (data) {
        //铃铛数目为0
        if (data == 0){
            $(".label-warning").addClass("hide");
        }else{
            $(".label-warning").removeClass("hide");
            $(".label-warning").html(data);
        }
    }, "json");
}
//打开二级页面
function openSecondPageNew(){
	window.location.href="${base}/platform/account/monitorNew";
}

//截取字符串省略展示-根据单元格长度确定
var subStrCustom =  function(data , length){
	var div= data ;
	if(data.length>length){
		var str =data ;
		div='<div  style="overflow: hidden;text-overflow: ellipsis;cursor: pointer;white-space:nowrap;" '+
		'title="'+data +'">'+str +'</div>'  ;
	}
			 
	return div ;
}	

var colorTemp ="${obj.colorTemp}"; //坐标轴颜色
var consoleSymbol="${obj.consoleSymbol}" ;
$(function(){
	//设置当前背景色
   //  colorTemp =getPageColor();
	 showRightTime();
	 //显示铃铛数量
    showMessageCount();
	 $("#logout").on("click",function(){
		window.location.href="${base!}/platform/login/logout";
	});
	 $("#changeTheme").on("click",function(){
		 loadingModal(true);
		changeThemeCss() ;
		
		if($("#departUseLine").length>0){
			reloadIndexData();
		}
		setTimeout("loadingModal(false)",500);
		
	}) ;
});
//loading图加载
function loadingModal(val) {
    if (val == true) {
        $("#loadModal").modal('show');
    } else if (val == false) {
        $("#loadModal").modal('hide');
    }
}

//改变css
function changeThemeCss(){
	 //当前位置为白色主题,切换到黑色主题
	var theme =  $.cookie("theme") ;
	var delcss = "index_w.css";
	var addcss = "index_b.css" ;
	var icon ="" ;
	if(theme=="black"){
	   theme="white" ;
	   delcss="index_b.css" ;
	   addcss="index_w.css" ;
	   colorTemp="#000000";
	   consoleSymbol="diamond";
	   icon="2"
	}else{
		theme="black" ;
	    colorTemp ="#F8F8FF";
	    consoleSymbol="emptyDiamond";
	}
	
	$.cookie("theme", null,{ path: "/",expires:-1}) // 删除 cookie
	$.cookie("theme", theme,{ path: "/", expires: 7 });
	replacejscssfile(delcss, addcss, "css","${base!}/assets/dist/css/");
	$("#bkimg").attr("src","${base!}/assets/dist/img/icon-header"+icon+".png") ;
}

//获取当前页面背景色
function getPageColor(){
	var theme =  $.cookie("theme") ;
	var color = "#000000"; //白色展示黑色
	consoleSymbol="diamond"//白色展示实体
	if(theme=="black"){//黑色展示白色
		color="#F8F8FF" ;
		consoleSymbol = "emptyDiamond" ;
	}
	return color ;
}

//创建
function createjscssfile(filename, filetype,url){
	
	if (filetype=="js"){
	var fileref=document.createElement('script')
	fileref.setAttribute("type","text/javascript")
	fileref.setAttribute("src", url+filename)
	}
	else if (filetype=="css"){
	var fileref=document.createElement("link")
	fileref.setAttribute("rel", "stylesheet")
	fileref.setAttribute("type", "text/css")
	fileref.setAttribute("href", url+filename)
	}
	return fileref
}
//替换 ;参数:旧的文件名,新的文件名,类型,路径
function replacejscssfile(oldfilename, newfilename, filetype,url){
	var targetelement=(filetype=="js")? "script" : (filetype=="css")? "link" : "none"
	var targetattr=(filetype=="js")? "src" : (filetype=="css")? "href" : "none"
	var allsuspects=document.getElementsByTagName(targetelement)
	for (var i=allsuspects.length; i>=0; i--){
		if (allsuspects[i] && allsuspects[i].getAttribute(targetattr)!=null && allsuspects[i].getAttribute(targetattr).indexOf(oldfilename)!=-1){
		   var newelement=createjscssfile(newfilename, filetype,url);
//		   allsuspects[i].parentNode.removeChild(allsuspects[i]);
		  allsuspects[i].parentNode.replaceChild(newelement, allsuspects[i]);
		}
	}
}
//加载css
function loadThemeLink( url ){
	document.getElementsByTagName( "head" )[0].appendChild( url );
}; 


</script>
    </body>
</html>